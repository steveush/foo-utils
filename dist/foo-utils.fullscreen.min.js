/*!
* FooUtils - Contains common utility methods and classes used in our plugins.
* @version 1.0.0
* @link https://github.com/steveush/foo-utils#readme
* @copyright Steve Usher 2021
* @license Released under the GPL-3.0 license.
*/

"use strict";!function(i,e,n){"1.0.0"===e.version&&(e.FullscreenAPI=e.EventClass.extend({construct:function(){this._super(),this.apis={w3:{enabled:"fullscreenEnabled",element:"fullscreenElement",request:"requestFullscreen",exit:"exitFullscreen",events:{change:"fullscreenchange",error:"fullscreenerror"}},webkit:{enabled:"webkitFullscreenEnabled",element:"webkitCurrentFullScreenElement",request:"webkitRequestFullscreen",exit:"webkitExitFullscreen",events:{change:"webkitfullscreenchange",error:"webkitfullscreenerror"}},moz:{enabled:"mozFullScreenEnabled",element:"mozFullScreenElement",request:"mozRequestFullScreen",exit:"mozCancelFullScreen",events:{change:"mozfullscreenchange",error:"mozfullscreenerror"}},ms:{enabled:"msFullscreenEnabled",element:"msFullscreenElement",request:"msRequestFullscreen",exit:"msExitFullscreen",events:{change:"MSFullscreenChange",error:"MSFullscreenError"}}},this.api=this.getAPI(),this.supported=null!=this.api,this.__listen()},destroy:function(){return this.__stopListening(),this._super()},getAPI:function(){for(var e in this.apis)if(this.apis.hasOwnProperty(e)&&this.apis[e].enabled in document)return this.apis[e];return null},element:function(){return this.supported?document[this.api.element]:null},request:function(e){if(this.supported&&e[this.api.request]){var t=e[this.api.request]();return t||i.Deferred(this.__resolver(this.api.request)).promise()}return n.rejected},exit:function(){if(this.supported&&this.element()){var e=document[this.api.exit]();return e||i.Deferred(this.__resolver(this.api.exit)).promise()}return n.rejected},toggle:function(e){return this.element()?this.exit():this.request(e)},__listen:function(){var e=this;e.supported&&i(document).on(e.api.events.change+".utils",function(){e.trigger("change")}).on(e.api.events.error+".utils",function(){e.trigger("error")})},__stopListening:function(){var e=this;e.supported&&i(document).off(e.api.events.change+".utils").off(e.api.events.error+".utils")},__resolver:function(r){var s=this;return function(e){function t(){e.resolve(),i(document).off(s.api.events.change,t).off(s.api.events.error,n)}function n(){e.reject(new TypeError),i(document).off(s.api.events.change,t).off(s.api.events.error,n)}r===s.api.exit&&s.element()?setTimeout(function(){e.reject(new TypeError)},1):i(document).on(s.api.events.change,t).on(s.api.events.error,n)}}}))}(FooUtils.$,FooUtils,FooUtils.fn);