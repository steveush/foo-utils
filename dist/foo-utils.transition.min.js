/*!
* FooUtils - Contains common utility methods and classes used in our plugins.
* @version 1.0.0
* @link https://github.com/steveush/foo-utils#readme
* @copyright Steve Usher 2021
* @license Released under the GPL-3.0 license.
*/

"use strict";!function(l,u,f,s){"1.0.0"===u.version&&(u.transition={},u.transition.dataName="__foo-transition__",u.transition.disableClassName=null,u.transition.timeout=3e3,u.transition.disable=function(t,e){var n,i,r,a=f.jq(t)?t:l(t);0<a.length&&f.fn(e)&&(n=a.get(0),r=null,(i=f.string(u.transition.disableClassName))?a.addClass(u.transition.disableClassName):(r={value:n.style.getPropertyValue("transition"),priority:n.style.getPropertyPriority("transition")},n.style.setProperty("transition","none","important")),e.call(e,a),a.prop("offsetWidth"),i?a.removeClass(u.transition.disableClassName):(n.style.removeProperty("transition"),f.string(r.value)&&0<r.value.length&&n.style.setProperty("transition",r.value,r.priority)))},u.transition.stop=function(t){var e,n=l.Deferred(),i=f.jq(t)?t:l(t);return 0<i.length?(e=i.data(u.transition.dataName),f.promise(e)?e.always(function(){u.requestFrame(function(){n.resolve(i)})}).reject(new Error("Transition cancelled.")):n.resolve(i)):n.reject(new Error("Unable to stop transition. Make sure the element exists.")),n.promise()},u.transition.createListener=function(t,e,n){var i=t,r=e,a=n,o=f.string(n);return function(t){var e=t.originalEvent instanceof TransitionEvent?t.originalEvent:t,n=!1;e.target===i&&(n=!o||e.propertyName===a),n&&r.apply(r,s.arg2arr(arguments))}},u.transition.start=function(t,n,i,r){var a,o=l.Deferred(),s=f.jq(t)?t:l(t);return 0<s.length&&f.fn(n)?(a=s.get(0),u.transition.stop(s).always(function(){var e=u.transition.createListener(a,function(){o.resolve(s)},i);s.data(u.transition.dataName,o).on("transitionend.foo-utils",e).prop("offsetWidth"),u.requestFrame(function(){var t=setTimeout(function(){o.reject(new Error("Transition safety timeout triggered."))},f.number(r)?r:u.transition.timeout);o.always(function(){clearTimeout(t),s.removeData(u.transition.dataName).off("transitionend.foo-utils",e)}),n.call(n,s)})})):o.reject(new Error("Unable to perform transition. Make sure the element exists and a trigger function is supplied.")),o.promise()},u.transition.modify=function(t,e,n,i){var r=f.jq(t)?t:l(t);return 0<r.length&&f.fn(e)?n?(u.transition.disable(r,e),s.resolve()):u.transition.start(r,e,i):s.reject(new Error("Unable to perform modification. Make sure the element exists and a modify function is supplied."))})}(FooUtils.$,FooUtils,FooUtils.is,FooUtils.fn);